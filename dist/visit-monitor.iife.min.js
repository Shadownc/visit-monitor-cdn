var VisitMonitor=function(){"use strict";const t="undefined"!=typeof window;return class{constructor(t={}){this.apiUrl=t.apiUrl||"https://example.com/api/log-visit",this.pvCount=0,this.uvCount=0,this.updateCallback=null}getOrCreateVisitorId(){let t=localStorage.getItem("visitor_id");return t||(t="visitor_"+Math.random().toString(36).substr(2,9),localStorage.setItem("visitor_id",t)),t}logVisit(){if(!t)return void console.warn("Not running in a browser environment");console.log(`Using API URL: ${this.apiUrl}`);const i=window.location.href,o=this.getOrCreateVisitorId();fetch(this.apiUrl,{method:"POST",headers:{"Content-Type":"application/json","X-Visitor-ID":o},body:JSON.stringify({url:i})}).then((t=>t.json())).then((t=>{console.log("访问记录成功:",t),this.pvCount=t.pvCount,this.uvCount=t.uvCount,this.triggerUpdate()})).catch((t=>{console.error("访问记录出错:",t),this.pvCount="N/A",this.uvCount="N/A",this.triggerUpdate()}))}onUpdate(t){this.updateCallback=t}triggerUpdate(){"function"==typeof this.updateCallback&&this.updateCallback(this.pvCount,this.uvCount)}init(){t&&window.addEventListener("load",(()=>{this.logVisit()}))}}}();
